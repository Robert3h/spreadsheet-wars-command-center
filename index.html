<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>試算表大戰 | Portfolio Galaxy 3.0 - 星雲版</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #000005;
        }
        #galaxy-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        #info-panel {
            display: none;
            position: absolute;
            width: 330px;
            padding: 18px 22px;
            background-color: rgba(10, 25, 47, 0.9);
            border: 1px solid #00aaff;
            border-radius: 8px;
            box-shadow: 0 0 25px rgba(0, 170, 255, 0.6);
            color: #e0f7fa;
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            transform: translate(30px, -50%); /* Offset from the node */
            pointer-events: all;
            backdrop-filter: blur(5px);
        }
        #info-panel h2 {
            font-size: 1.25em;
            margin: 0 0 10px 0;
            color: #76d7c4;
        }
        #info-panel p {
            font-size: 0.9em;
            margin: 5px 0;
            line-height: 1.6;
        }
        #info-panel a {
            display: inline-block;
            margin-top: 15px;
            padding: 8px 14px;
            border: 1px solid #76d7c4;
            border-radius: 4px;
            color: #76d7c4;
            text-decoration: none;
            transition: background-color 0.3s, color 0.3s;
        }
        #info-panel a:hover {
            background-color: #76d7c4;
            color: #0a192f;
        }
    </style>
</head>
<body>
    <div id="galaxy-container"></div>
    <div id="info-panel">
        <h2 id="info-title"></h2>
        <p id="info-date"></p>
        <p id="info-summary"></p>
        <a id="info-link" href="#" target="_blank">閱讀全文</a>
    </div>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>
    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        const articles = [
            // EP1-14
            { id: "EP01", type: "EP", date: "2025-03-11", title: "EP01《試算表大戰首部曲：…同事滑手機還能準時下班的秘密！》", summary: "一個VBA學徒踏上尋找自動化之道的冒險，迎向傳說中的大師──ChatGPT！" },
            { id: "EP02", type: "EP", date: "2025-03-18", title: "EP02《試算表大戰二部曲：當主管對我說「這工作我真的沒辦法…」》", summary: "當自動化的力量開始改變團隊，一場Excel革命正在醞釀，VBA的影響力不止於個人，而是改變整個戰局！" },
            { id: "EP03", type: "EP", date: "2025-03-25", title: "EP03《試算表大戰三部曲：三個Excel小技巧，讓你的報表更強大！》", summary: "分享三個實用技巧：善用內建函數、將參數表格化管理，以及封裝重複的程式碼，讓Excel報表更靈活、易維護。" },
            { id: "EP04", type: "EP", date: "2025-04-01", title: "EP04《試算表大戰四部曲：從動物烏托邦體會到的Try Everything之道！》", summary: "從學習VBA的過程中體悟到，重要的不是工具本身，而是保持好奇心與行動力，勇敢嘗試每一種解決問題的可能。" },
            { id: "EP05", type: "EP", date: "2025-04-08", title: "EP05《試算表大戰五部曲：VBA檢核艦隊的最後防線！》", summary: "分享如何用VBA打造一個「檔案命名檢查器」，自動化檢查報表是否符合命名規則並存放在正確路徑，解決管理難題。" },
            { id: "EP06", type: "EP", date: "2025-04-22", title: "EP06《試算表大戰六部曲：VBA飛行員總有一天會被AI無人機淘汰！》", summary: "探討在AI時代下，VBA等傳統工具的價值。結論是，決定成敗的不是工具，而是使用工具的人，活在當下解決問題最重要。" },
            { id: "EP07", type: "EP", date: "2025-04-29", title: "EP07《試算表大戰七部曲：…如何在職場戴上心智的頭盔！》", summary: "分享一次職場衝突經歷，如何將被誤解與否定的感受，轉化為專注於專業、不再討好的堅毅心態。" },
            { id: "EP08", type: "EP", date: "2025-05-13", title: "EP08《試算表大戰八部曲：職場就像一盒巧克力…》", summary: "面對職場上突如其來的奇特任務，如何轉念將其視為練習機會，將需求拆解並用VBA實作出解決方案。" },
            { id: "EP09", type: "EP", date: "2025-05-29", title: "EP09《試算表大戰九部曲：當升遷的直升機來臨，我猶豫後選擇走樓梯！》", summary: "婉拒一次看似完美的升遷機會後，選擇走另一條路，反而開啟了更貼近內心與熱情的職涯方向。" },
            { id: "EP10", type: "EP", date: "2025-06-12", title: "EP10《試算表大戰十部曲：…按鈕讓信件像洲際飛彈劃過天際》", summary: "分享如何使用VBA結合Outlook，將重複且需分眾的郵件寄送工作，變成一鍵發送的自動化流程。" },
            { id: "EP11", type: "EP", date: "2025-06-26", title: "EP11《試算表大戰十一部曲：電影雷霆特攻隊觀後感──接納自己的原廠設定！》", summary: "從電影觀後感反思，並透過與AI對話，重新認識自己對效率與掌控感的「原廠設定」，學會誠實接納自己。" },
            { id: "EP12", type: "EP", date: "2025-07-10", title: "EP12《試算表大戰十二部曲：被重複性報表不斷折磨後，前往談判的時間博士！》", summary: "面對重複性報表地獄，將流程拆解並打造成可重複使用的VBA函數庫，主動掌握流程，擺脫被動折磨。" },
            { id: "EP13", type: "EP", date: "2025-07-24", title: "EP13《Spreadsheet Wars：唯一確定的，就是「什麼都不確定」…》", summary: "在獲得升遷後，反而引發對自身價值的反思。面對合併案的高度不確定性，決定向內聚焦，專注於長期價值的建立。" },
            { id: "EP14", type: "EP", date: "2025-08-07", title: "EP14《Spreadsheet Wars：雖然我沒有辦法把Excel玩成電競…》", summary: "從Excel世界大賽得到啟發，雖然無法成為頂尖高手，但透過打造自己的VBA模組艦隊，贏得了寶貴的個人時間。" },
            { id: "SP01", type: "SP", date: "2025-04-05", title: "SP01《…「破窗效應」對報表與生活環境帶來Bug》", summary: "以VBA報表除錯為喻，探討生活中的「破窗效應」，呼籲大家正視並修復身邊沉默的錯誤，守護共同價值。" },
            { id: "SP02", type: "SP", date: "Unknown", title: "SP02《…地基不穩，再美好的生活與工作都是幻影》", summary: "探討國安議題，強調在重大議題上沒有中立，不選擇的結果將由別人決定，呼籲大家為自己的未來做出選擇。" },
            { id: "SP03", type: "SP", date: "2025-07-04", title: "SP03《…一部關於台灣過去、現在與未來的紀錄片》", summary: "紀錄片《造山者》觀後感，對台灣半導體前輩們的遠見與賭注感到震撼，並反思個人在安逸環境下的責任與選擇。" },
            { id: "SP04", type: "SP", date: "2025-07-23", title: "SP04《…我不想等飛機真的下墜時，才開始去搶降落傘！》", summary: "分享準備家庭災難包的過程與思考，強調在複合式風險面前，提前準備不是製造焦慮，而是愛與責任的體現。" },
            { id: "TLDR01", type: "TLDR", date: "2025-06-15", title: "TLDR_EP01《震波行動：一鍵發射你的 Outlook 洲際彈道導彈》", summary: "一頁圖文懶人包，展示如何用VBA將重複的Outlook寄信工作自動化，精準命中目標。" },
            { id: "TLDR02", type: "TLDR", date: "2025-07-14", title: "TLDR_EP02《俠盜一號：帝國指揮官的報表命名檢查器》", summary: "一頁圖文懶人包，介紹一個VBA小工具，能自動檢查多份報表的命名規則與路徑，確保檔案不遺漏。" },
            { id: "TLDR03", type: "TLDR", date: "2025-07-28", title: "TLDR_EP03《時間博士：設計魔法函數前去和重複黑暗魔王談判》", summary: "一頁圖文懶人包，分享如何將重複的流程模組化，打造自己的VBA函數庫，對抗重複工作的黑暗魔王。" },
            { id: "TLDR04", type: "TLDR", date: "2025-08-11", title: "TLDR_EP04《Excel竟然變成電競比賽？》", summary: "一頁圖文懶人包，介紹Excel世界大賽的趣聞，並分享自己打造的VBA陣列過濾函數，提升工作效率。" }
        ];

        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 30;

        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById('galaxy-container').appendChild(renderer.domElement);

        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        controls.screenSpacePanning = false;
        controls.minDistance = 5;
        controls.maxDistance = 100;

        // --- Nebula & Stars ---
        const starTexture = new THREE.TextureLoader().load('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABFklEQVRYR+3VwQnCUBCE4X8GChDCGG3EJo6ikWiGzAxp4gB2cCchBIIgIBvM4Bq8k4QRyZBA3iT9f6gH2qf/+7f3JwgwzDAGeLwA8sEz0JDDH7lAj9kMYHkPZAG/A2LAc9ANDHqGAXmQIdwD6zYC44DuwDYwA14Ci5AF2IfsQxI4Ci5AGbiG7EF+IccwB5YgC5wL9yEPfAonwL2QYyI4CVyDPfAynAN2YQfkQMVyAnwLZsA/kANuYQe8BJagD/wBGSA3fAt2gLvgCdgCvgCbwB3YAj6AHbAFnAGNwBHwAnwDzwFPYAe8BxIgDzzCCJgDr8EXsAeeQU+An+A28Aw8Ay/BH/AQPIIfwDfwE3gG/gY/gZ/gj/AD/Aj/AF/DP/Bf/Av+Bc+AJ+A58BW4Ctz/AM4C/gH08QJ2a0DA3wAAAABJRU5ErkJggg==');
        
        function createStarfield() {
            const vertices = [];
            for (let i = 0; i < 10000; i++) {
                const x = THREE.MathUtils.randFloatSpread(200);
                const y = THREE.MathUtils.randFloatSpread(200);
                const z = THREE.MathUtils.randFloatSpread(200);
                vertices.push(x, y, z);
            }
            const geometry = new THREE.BufferGeometry();
            geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));
            const material = new THREE.PointsMaterial({ color: 0x888888, size: 0.1 });
            const stars = new THREE.Points(geometry, material);
            scene.add(stars);
        }

        function createNebula() {
            const nebulaMaterial = new THREE.SpriteMaterial({
                map: starTexture,
                color: 0x6f42c1,
                blending: THREE.AdditiveBlending,
                opacity: 0.3,
                transparent: true,
                sizeAttenuation: true
            });
            for (let i = 0; i < 50; i++) {
                const sprite = new THREE.Sprite(nebulaMaterial.clone());
                sprite.position.set(
                    (Math.random() - 0.5) * 30,
                    (Math.random() - 0.5) * 20,
                    (Math.random() - 0.5) * 20 - 15
                );
                sprite.scale.set(
                    (Math.random() + 0.5) * 8,
                    (Math.random() + 0.5) * 8,
                    1
                );
                scene.add(sprite);
            }
        }

        createStarfield();
        createNebula();

        const objects = [];
        const constellationCenters = {
            EP: new THREE.Vector3(-15, 5, 0),
            SP: new THREE.Vector3(15, -5, 0),
            TLDR: new THREE.Vector3(0, -10, 5)
        };
        const constellationRadius = { EP: 10, SP: 6, TLDR: 6 };
        const colorMap = { EP: 0x00aaff, SP: 0xff4444, TLDR: 0xffff00 };

        articles.forEach(article => {
            const geometry = new THREE.SphereGeometry(0.5, 32, 32);
            const material = new THREE.MeshBasicMaterial({ color: colorMap[article.type] });
            const sphere = new THREE.Mesh(geometry, material);

            const center = constellationCenters[article.type];
            const radius = Math.random() * constellationRadius[article.type];
            const angle = Math.random() * Math.PI * 2;
            sphere.position.set(
                center.x + Math.cos(angle) * radius,
                center.y + Math.sin(angle) * radius,
                center.z + (Math.random() - 0.5) * 5
            );

            sphere.userData = article;
            scene.add(sphere);
            objects.push(sphere);
        });

        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2();
        const infoPanel = document.getElementById('info-panel');
        let selectedObject = null;

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }
        window.addEventListener('resize', onWindowResize, false);

        function onClick(event) {
            if (infoPanel.style.display === 'block' && infoPanel.contains(event.target)) {
                return;
            }
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = - (event.clientY / window.innerHeight) * 2 + 1;
            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObjects(objects);

            if (intersects.length > 0) {
                selectedObject = intersects[0].object;
                const data = selectedObject.userData;
                document.getElementById('info-title').textContent = data.title;
                document.getElementById('info-date').textContent = "發布於：" + data.date;
                document.getElementById('info-summary').textContent = data.summary;
                document.getElementById('info-link').href = "#" + data.id;
                infoPanel.style.display = 'block';
                updatePanelPosition();
            } else {
                selectedObject = null;
                infoPanel.style.display = 'none';
            }
        }
        window.addEventListener('click', onClick);

        function updatePanelPosition() {
            if (selectedObject && infoPanel.style.display === 'block') {
                const screenPos = selectedObject.position.clone().project(camera);
                infoPanel.style.left = `${(screenPos.x + 1) / 2 * window.innerWidth}px`;
                infoPanel.style.top = `${(-screenPos.y + 1) / 2 * window.innerHeight}px`;
            }
        }

        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            updatePanelPosition();
            renderer.render(scene, camera);
        }
        animate();
    </script>
</body>
</html>
